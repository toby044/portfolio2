import{L as y,r as b,I as s,o as R,X as z,d as O,e as A,au as _,Q as u,f as d,av as D,h as F,aa as k,B as m,a5 as q,ab as I,g as H}from"./BDkesJ-x.js";import{u as W}from"./DDFplSJy.js";import{u as x}from"./C7HUDyTz.js";import{u as M}from"./BbfgnpIe.js";import{u as Q}from"./MuHLDO_N.js";import U from"./BcvwtPUr.js";import"./B0odRWjR.js";function X(g){const c=Q("vimeoPlayer",()=>({scriptInput:{src:"https://player.vimeo.com/api/player.js"},scriptOptions:{use(){return{Vimeo:window.Vimeo}}}}),g);{const p=y(c.status,o=>{o==="loading"&&(M({link:[{rel:"preconnect",href:"https://i.vimeocdn.com"},{rel:"preconnect",href:"https://f.vimeocdn.com"},{rel:"preconnect",href:"https://fresnel.vimeocdn.com"}]}),p())})}return c}const oe={__name:"ScriptVimeoPlayer",props:{trigger:{type:[String,Array,Boolean],required:!1,default:"mousedown"},placeholderAttrs:{type:Object,required:!1},rootAttrs:{type:Object,required:!1},aboveTheFold:{type:Boolean,required:!1},vimeoOptions:{type:Object,required:!1},id:{type:null,required:!1},url:{type:null,required:!1}},emits:["play","playing","pause","ended","timeupdate","progress","seeking","seeked","texttrackchange","chapterchange","cuechange","cuepoint","volumechange","playbackratechange","bufferstart","bufferend","error","loaded","durationchange","fullscreenchange","qualitychange","camerachange","resize","enterpictureinpicture","leavepictureinpicture"],setup(g,{expose:c,emit:p}){const o=g,P=p,T=["play","playing","pause","ended","timeupdate","progress","seeking","seeked","texttrackchange","chapterchange","cuechange","cuepoint","volumechange","playbackratechange","bufferstart","bufferend","error","loaded","durationchange","fullscreenchange","qualitychange","camerachange","resize","enterpictureinpicture","leavepictureinpicture"],l=b(),w=b(),n=x({trigger:o.trigger,el:w});let h=!1;o.trigger==="mousedown"&&n instanceof Promise&&n.then(t=>{t&&(h=!0)});const f=b(!1),{onLoaded:S,status:i}=X({scriptOptions:{trigger:n}}),V=s(()=>{var t;return((t=o.vimeoOptions)==null?void 0:t.id)||o.id}),$=s(()=>`vimeo-embed:${V.value}`),{data:L}=W($,()=>$fetch("https://vimeo.com/api/oembed.json",{params:{url:`https://vimeo.com/${V.value}`,format:"json"}}),{lazy:!0}),v=s(()=>{var t;return(t=L.value)==null?void 0:t.thumbnail_url});let e;c({play:()=>e==null?void 0:e.play(),pause:()=>e==null?void 0:e.pause(),getDuration:()=>e==null?void 0:e.getDuration(),getCurrentTime:()=>e==null?void 0:e.getCurrentTime(),setCurrentTime:t=>e==null?void 0:e.setCurrentTime(t),getVolume:()=>e==null?void 0:e.getVolume(),setVolume:t=>e==null?void 0:e.setVolume(t),getPaused:()=>e==null?void 0:e.getPaused(),getEnded:()=>e==null?void 0:e.getEnded(),getLoop:()=>e==null?void 0:e.getLoop(),setLoop:t=>e==null?void 0:e.setLoop(t),getPlaybackRate:()=>e==null?void 0:e.getPlaybackRate(),setPlaybackRate:t=>e==null?void 0:e.setPlaybackRate(t)});const j=s(()=>{var t,r,a;return((t=o.vimeoOptions)==null?void 0:t.width)||((a=(r=l.value)==null?void 0:r.parentNode)==null?void 0:a.offsetWidth)||640}),B=s(()=>{var t,r,a;return((t=o.vimeoOptions)==null?void 0:t.height)||((a=(r=l.value)==null?void 0:r.parentNode)==null?void 0:a.offsetHeight)||480});R(()=>{S(async({Vimeo:t})=>{const r=o.vimeoOptions||{};!r.id&&o.id&&(r.id=o.id),!r.url&&o.url&&(r.url=o.url),r.width=j.value,r.height=B.value,e=new t.Player(l.value,r),h&&(e.play(),h=!1);for(const a of T)e.on(a,N=>{P(a,N,e),a==="loaded"&&(f.value=!0)})})}),y(()=>o.id,t=>{t&&(e==null||e.loadVideo(Number(t)))}),y(i,t=>{t==="error"&&P("error")});const C=s(()=>q(o.rootAttrs,{"aria-busy":i.value==="loading","aria-label":i.value==="awaitingLoad"?"Vimeo Player - Placeholder":i.value==="loading"?"Vimeo Player - Loading":"Vimeo Player - Loaded","aria-live":"polite",role:"application",style:{maxWidth:"100%",width:"auto",height:"auto",aspectRatio:"16/9",position:"relative",backgroundColor:"black"},...n instanceof Promise?n.ssrAttrs||{}:{}})),E=s(()=>q(o.placeholderAttrs,{src:v.value,alt:"",loading:o.aboveTheFold?"eager":"lazy",fetchpriority:o.aboveTheFold?"high":void 0,style:{cursor:"pointer",width:"100%",objectFit:"contain",height:"100%"}}));return z(()=>e==null?void 0:e.unload()),(t,r)=>(A(),O("div",k({ref_key:"rootEl",ref:w},C.value),[_(F("div",{ref_key:"elVimeo",ref:l,class:"vimeo-player"},null,512),[[D,f.value]]),f.value?d("",!0):u(t.$slots,"placeholder",k({key:0},m(L),{placeholder:v.value}),()=>[v.value?(A(),O("img",I(k({key:0},E.value)),null,16)):d("",!0)]),m(i)==="loading"?u(t.$slots,"loading",{key:1},()=>[H(U,{color:"white"})]):d("",!0),m(i)==="awaitingLoad"?u(t.$slots,"awaitingLoad",{key:2}):m(i)==="error"?u(t.$slots,"error",{key:3}):d("",!0),u(t.$slots,"default")],16))}};export{oe as default};
